name: deploy-digital-ocean
on:
    workflow_run:
        workflows: [frontend, playwright]
        branches: [master]
        types:
            - completed

jobs:
  build-and-deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' && github.event.pull_request.merged }}
    runs-on: self-hosted
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Build and run app     
        run: docker-compose -f docker-compose-prod.yml up -d --build
